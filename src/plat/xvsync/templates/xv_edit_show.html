{% load myTag static %}

	<script>
        function pageCheck()
        {
            try {
                var x=document.getElementById("{{channel_id}}_page_go").value;
                if(x=="")    throw "值为空";
                if(isNaN(x)) throw "不是数字";
                if(x>{{ page_count }})     throw "页数太大";
                if(x<1)      throw "页数太小";
            }
            catch(err) {
                var y=document.getElementById("err_doc");
                y.innerHTML="错误：" + err + "。";
                event.returnvalue=false;
                return
            }
            //location.href = "?page="+x+"&count="+{{count}};
            //$('#'+{{ channel_id }}).load("{% url 'xv_edit_show' %}", {"channel_id":{{ channel_id }},"page":x,"count":{{count}},"cond":'{{cond}}',"content":'{{content}}'});
            window.location.href = "/xvsync/xv_edit?channel_id={{ channel_id }}"+"&content={{content}}"+"&page="+x+"&cond={{cond}}"+"&screen={{screen}}";
        }
        
        function turnPage(xxx,yyy){
	    	//$('#'+{{ channel_id }}).load("{% url 'xv_edit_show' %}", {"channel_id":{{ channel_id }},"page":xxx,"count":yyy,"cond":'{{cond}}',"content":'{{content}}'}); //ajax加载页面
	    	window.location.href = "/xvsync/xv_edit?channel_id={{ channel_id }}"+"&content={{content}}"+"&page="+xxx+"&cond={{cond}}"+"&screen={{screen}}";
		}
		
	</script>
	
    <style type="text/css">
        img {
            width:40px;
            height:50px;
        }
        td {
		    text-align:center;
		    margin:auto;
		}
    </style>
    
	<fieldset>
        <table class="table table-striped table-bordered table-condensed">
            <thead>
                <tr>
                    <td width="7%">媒体ID</td>
                    <td width="7%">海报</td>
                    <td width="10%">媒体名称</td>
                    <td width="10%">导演</td>
                    <td width="12%">演员</td>
                    <td width="25%">简介</td>
                    <td width="13%">类型</td>
                    <td width="8%">年份</td>
                    <td width="8%">地区</td>
                </tr>
            </thead>
            <tbody>
            	{% for data in video_list %}
            		<tr>	
						<td>{{ data.mid }}</td>
						<td>
							<a href="{% url 'media_edit_details' %}?mid={{data.cid}}&channel_id={{channel_id}}" target="workspace">
								<img src="{{ posters_path }}{{ data.poster }}"/>
							</a>
						</td>	
						<td>
							<h6>
								<a href="{% url 'media_edit_details' %}?mid={{data.cid}}&channel_id={{channel_id}}" target="workspace">{{ data.title }}
								</a>
							</h6>
						</td>
                        <td>{{ data.director|default_if_none:"(暂无)" }}</td>
                        <td>{{ data.actor|default_if_none:"(暂无)" }}</td>
                        <td>{{ data.intro|default_if_none:"(暂无)"|truncatewords_html:"3" }}</td>
                        <td>{{ data.type|default_if_none:"(暂无)" }}</td>
                        <td>{{ data.release_date|date:"Y-m-d" }}</td>
                        <td>{{ data.district }}</td>
                    </tr>
				{% endfor %}
			</tbody>
		</table>
	</fieldset>		

    <div>			
    	<table class="table">
            <tbody>
                <tr>
                    <td>总计<b>{{ video_total }}</b>条, <b>{{ page_count }}</b>页 </td>
                    <td>
                        <div>
                        	第<input class="text span1" id="{{channel_id}}_page_go" name="page" value={{page}} placeholder="几" onkeypress="if(event.keyCode==13||event.which==13){return pageCheck()}">页
                            <input id="page_subit" type="button" value="转到" class="btn btn-primary" onclick="pageCheck()"></input>
                            <p id="err_doc"></p>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>	
	
	<div class="pagination pagination-large">
        <ul>
            {% if page > 1%}
                <li><a href="#" onclick='turnPage("1","{{count}}")'>&lt;&lt;</a> </li>
                <li><a href="#" onclick='turnPage("{{page|add:-1}}","{{count}}")'>&lt;</a></li>
            {% else %}
                <li class="disabled"><a>&lt;&lt;</a> </li>
                <li class="disabled"><a>&lt;</a> </li>
            {% endif %}

            {% for pg in page_list %}
                {% if pg == page %}
                    <li><a class="btn btn-success" href="#" onclick='turnPage("{{pg}}","{{count}}")'>{{pg}}</a></li>
                {% else %}
                    <li><a href="#" onclick='turnPage("{{pg}}","{{count}}")'>{{pg}}</a></li>
                {% endif %}
            {% endfor %}

            {% if page < page_count %}
                <li><a href="#" onclick='turnPage("{{page|add:1}}","{{count}}")'>&gt;</a></li>
                <li><a href="#" onclick='turnPage("{{page_count}}","{{count}}")'>&gt;&gt;</a></li>
            {% else %}
                <li class="disabled"><a>&gt;</a></li>
                <li class="disabled"><a>&gt;&gt;</a></li>
            {% endif %}
        </ul>
    </div>        		        
		



