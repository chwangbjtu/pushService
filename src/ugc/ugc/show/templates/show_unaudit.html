{% load mathfilters %}
{% load dictionary_extras %}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="  ext-strict x-viewport" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <title>风行UGC系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/libs/twitter-bootstrap/2.3.1/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
      table {
          table-layout: fixed;
          word-wrap: break-word;
      }
        .pagination.center,
        .pagination.center ul {
            float: left;
            position: relative;
        }
        .pagination.center { left: 50%; }
        .pagination.center ul { left: -50%; }
    </style>
    <link href="/static/libs/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet">

    <script src="/static/libs/jquery/jquery-1.9.1.min.js"></script>
    <script src="/static/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function() {
            {% for ft in origin_filter %}
                {% if ft.0 == origin %}
                    change_origin_item("{{ ft.1 }}", "{{ ft.0 }}");
                {% endif %}
            {% endfor %}
            {% for ft in sort_filter %}
                {% if ft.0 == sort %}
                    change_sort_item("{{ ft.1 }}", "{{ ft.0 }}");
                {% endif %}
            {% endfor %}
        });
    </script>

    <script>
        function change_origin_item(content, val)
        {
            document.getElementById("origin_item").innerHTML=content + " <span class=\"caret\"></span>";
            document.getElementById("origin_box").value = val
        }
        function change_sort_item(content, val)
        {
            document.getElementById("sort_item").innerHTML=content + " <span class=\"caret\"></span>";
            document.getElementById("sort_box").value = val
        }
    </script>
</head>

<body id="ext-gen3" class="body_class" scroll="no" style="width:100%;height:100%;margin:0 auto;">
    <h1 class="text-center">UGC审核系统</h1>
    <div class="container">
        <div class="row">
            <div class="span12">
                <form id='list_form' action="" method="GET">
                    <table>
                        <tr>
                            <td class="span4">
                                <div>
                                    <div class="btn-group">
                                        <a class="btn dropdown-toggle" id="origin_item" data-toggle="dropdown" href="#">
                                            <span class="caret"></span>
                                        </a>
                                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                                            {% for ft in origin_filter %}
                                                <li><a tabindex="-1" href="javascript:change_origin_item('{{ ft.1 }}', '{{ ft.0 }}')">{{ ft.1 }}</a></li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    <input class="text" id='origin_box' style="display:none" name="origin" value=""></input>

                                    <button id="filter" type="submit" class="btn btn-primary">筛选</button>
                                </div>
                            </td>
                            <td class="span4">
                                <div>
                                    <div class="btn-group">
                                        <a class="btn dropdown-toggle" id="sort_item" data-toggle="dropdown" href="#">
                                            <span class="caret"></span>
                                        </a>
                                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                                            {% for ft in sort_filter %}
                                                <li><a tabindex="-1" href="javascript:change_sort_item('{{ ft.1 }}', '{{ ft.0 }}')">{{ ft.1 }}</a></li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    <input class="text" id='sort_box' style="display:none" name="sort" value=""></input>

                                    <button id="filter" type="submit" class="btn btn-primary">排序</button>
                                </div>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>

            <div class="span12">
                <form action="?page={{ page }}&count={{ count }}&origin={{ origin }}&sort={{sort}}" method="POST">
                    <fieldset>
                    <table class="table table-striped table-bordered table-hover table-condensed" width="100%">
                        <thead>
                            <tr id="liebiao" width="100%">
                                <td width="4%">审核</td>
                                <td width="30%">标题</td>
                                <td>频道</td>
                                <td width="30%">标签</td>
                                <td>优先级</td>
                                <td width="8%">创建时间</td>
                                <td width="8%">发布时间</td>
                                <td>用户</td>
                                <td>网站</td>
                                <td width="6%">操作</td>
                            </tr>
                        </thead>
                        <tbody>
                            {% for video in video_list %}
                                <tr>
                                    {% if not audit_task|access:video.tid %}
                                        <td><input name="sel" type="checkbox" value="{{ video.tid }}" /></td>
                                    {% else %}
                                        <td>{{ audit_task|access:video.tid }}</td>
                                    {% endif %}
                                    <td>{{video.title}}</td>
                                    <td>{{video.channel}}</td>
                                    <td>{{video.tags}}</td>
                                    <td>{{video.priority}}</td>
                                    <td>{{video.ctime|date:"Y-m-d"}}</td>
                                    <td>{{video.pub_time|date:"Y-m-d"}}</td>
                                    <td>{{video.username}}</td>
                                    <td>{{video.site}}</td>
                                    <td> <a class="btn btn-primary" href="/audit/showvideo?tid={{ video.tid }}" >查看</a> </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button id="apply" type="submit" class="btn btn-primary">申请</button>
                    </fieldset>
                </form>
            </div>

            <div class="span12">
                <p> 总计<b>{{ total }}</b>条, <b>{{ page_count }}</b>页 </p>
            </div>

            <div class="span12">
                <div class="pagination pagination-large center">
                    <ul>
                        {% if page > 1%}
                            <li> <a href="?page=1&count={{ count }}&origin={{ origin }}&sort={{sort}}">&lt;&lt;</a> </li>
                            <li><a href="?page={{ page|sub:1}}&count={{ count }}&origin={{ origin }}&sort={{sort}}">&lt;</a></li>
                        {% else %}
                            <li class="disabled"><a>&lt;&lt;</a> </li>
                            <li class="disabled"><a>&lt;</a> </li>
                        {% endif %}

                        {% for pg in page_list %}
                            {% if pg == page %}
                                <li><a class="btn btn-success" href="?page={{ pg }}&count={{ count }}&origin={{ origin }}&sort={{sort}}">{{ pg }}</a></li>
                            {% else %}
                                <li><a href="?page={{ pg }}&count={{ count }}&origin={{ origin }}&sort={{sort}}">{{ pg }}</a></li>
                            {% endif %}
                        {% endfor %}

                        {% if page < page_count %}
                            <li><a href="?page={{ page|add:1 }}&count={{ count }}&origin={{ origin }}&sort={{sort}}">&gt;</a></li>
                            <li><a href="?page={{ page_count }}&count={{ count }}&origin={{ origin }}&sort={{sort}}">&gt;&gt;</a></li>
                        {% else %}
                            <li class="disabled"><a>&gt;</a></li>
                            <li class="disabled"><a>&gt;&gt;</a></li>
                        {% endif %}
                    </ul>
                </div>
            </div>

        </div>
    </div>
</body>
</html>
