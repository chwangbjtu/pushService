
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bootstrap, from Twitter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/libs/twitter-bootstrap/2.3.1/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
      #main{
        width:60%;
        margin: 0 auto;
      }

    </style>
    <link href="/static/libs/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link type="text/css" href="/static/css/datepicker.css" rel="stylesheet" />
    <script src="/static/libs/jquery/jquery-1.9.1.min.js"></script>
    <script src="/static/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>

    <script type="text/javascript" >
      function parse_date(date){
        var re = /^(\d{4})-(\d{1,2})-(\d{1,2})$/
        if(!re.test(date)){
          return null;
        }
        var segs = date.split("-");
        var year = parseInt(segs[0]);
        var month = parseInt(segs[1])-1;
        var day = parseInt(segs[2]);
        var result = new Date();
        result.setFullYear(year,month,day);
        if(result.getFullYear()!=year || result.getMonth()!=month || result.getDate()!=day){
          return null;
        }
        return result;
      }

      function clearTips(){
        var ids = new Array("count_tips","start_tips","end_tips");
        for (var i = 0; i < ids.length; i++) {
          document.getElementById(ids[i]).innerText = "";
        };
      }

      function on_submit(){
        //数量
        var error = "请输入小于100的正数";
        var count = document.getElementById("task_form").count.value;
        var re = /^(\d{1,3})$/;
        if(!re.test(count)){
          document.getElementById("count_tips").innerText = error;
          return false;
        }
        count = parseInt(count);
        if (count < 0 || count > 100){
          document.getElementById("count_tips").innerText = error;
          return false;
        }

        error = "格式有误";
        //校验时间
        var startDate = null,endDate = null;
        var start = document.getElementById("task_form").start.value;
        if(start){
          startDate = parse_date(start);
          if(startDate == null){
            clearTips();
            document.getElementById("start_tips").innerText = error;
            return false;
          }  
        }
        var end = document.getElementById("task_form").end.value;
        if(end){
          endDate = parse_date(end);
          if(endDate == null){
            clearTips();
            document.getElementById("end_tips").innerText = error;
            return false;
          }  
        }
        
        if(startDate && endDate && startDate > endDate){
          clearTips();
          document.getElementById("start_tips").innerText = "起始时间不应晚于截止时间";
          return false;
        }


        return true;
      }
    </script>
  </head>

  <body>
    <div id="main">
      <form class="form-horizontal" id="task_form" method="POST" action="/audit/applytask" onsubmit="return on_submit();">      
        {% csrf_token %}

        <div class="control-group">
          <label class="control-label" >数量：</label>
          <div class="controls">
            <input type="text" class="span3" name="count" placeholder="输入申请数量" >
            <font color="red" id="count_tips"></font>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label" >标题：</label>
          <div class="controls">
              <input type="text" class="span3" name="title" placeholder="输入欲包含的关键字">
          </div>
        </div>

        <div class="control-group">
          <label class="control-label">频道：</label>
          <div class="controls">
              <select name="channel" class="span3" >
                <option></option>
                <option>科技</option>
                <option>汽车</option>
                <option>生活</option>
                <option>旅游</option>
                <option>游戏</option>
                <option>音乐</option>
                <option>搞笑</option>
                <option>时尚</option>
                <option>资讯</option>
                <option>体育</option>
                <option>电影</option>
                <option>拍客</option>
                <option>教育</option>
                <option>军事</option>
                <option>第一财经</option>
                <option>美容</option>
                <option>婚嫁</option>
                <option>美食</option>
                <option>宠物</option>
                <option>母婴</option>
                <option>达人</option>
                <option>动漫</option>
                <option>综艺</option>
                <option>舞蹈</option>
                <option>纪录片</option>
                <option>广告</option>
                <option>原创</option>
                <option>美女</option>
                <option>相声</option>
                <option>娱乐</option>
                <option>明星</option>
                <option>预告片</option>
                <option>微电影</option>
                <option>网剧</option>
                <option>健康</option>
                <option>新闻</option>
              </select>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label">来源：</label>
          <div class="controls">
              <select name="site" class="span3" >
                <option></option>
                <option>yk</option>
                <option>td</option>
                <option>k6</option>
                <option>56</option>
              </select>
          </div>
        </div>
        
        <div class="control-group">
          <label class="control-label" >起始时间：</label>
          <div class="controls">
              <div class="input-append date" id="dp3" data-date="" data-date-format="yyyy-mm-dd">
                <input class="span2" name="start" type="text" >
                <span class="add-on"><i class="icon-calendar"></i></span>
              </div>
              <font color="red" id="start_tips"></font>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label" >截止时间：</label>
          <div class="controls">
              <div class="input-append date" id="dp4" data-date="" data-date-format="yyyy-mm-dd">
                <input class="span2" name="end" type="text" >
                <span class="add-on"><i class="icon-calendar"></i></span>
              </div>
              <font color="red" id="end_tips"></font>
          </div>
        </div>

        <div class="control-group">
          <div class="controls">
            <button type="submit" class="btn" style="margin-left:230px;">提交</button>
          </div>
        </div>

      </form>
    </div>

    <script type="text/javascript" src="/static/js/bootstrap-datepicker.js"></script>
    <script type="text/javascript">
      $('#dp3').datepicker();
      $('#dp4').datepicker();
    </script>

  </body>
    
</html>
